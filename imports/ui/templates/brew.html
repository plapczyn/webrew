<template name="brew">
  <div id="{{#if currentUser}}hero{{else}}hero-login{{/if}}">
    <div class="header">
      <h1><a id="title">reBrew</a></h1>
      <p>The world's foremost coffee network.</p>
      {{#if currentUser}}
      <p> My name is {{> loginButtons }} and I love coffee! </p>
      {{else}}
      <p> I'm a member, <span style="a:link{color: white}">{{> loginButtons }}</span></p>
      {{/if}}
    </div>
    {{#if currentUser}}
      <ul class="nav nav-pills pull-right">
        <li role="presentation"><input type="text" name="search" class="form-control search" width="250px" placeholder="Find a brew..."></li>
        <li role="presentation" class="active"><a href="/">Home</a></li>
        <li role="presentation"><a href="/new">New Brew</a></li>
        <li role="presentation"><a class="goMe" style="cursor:pointer">Me</a></li>
      </ul>
    {{/if}}
  </div>
  {{#if isReady}}
  {{#if currentUser}}
  {{#each brew}}
  <div class="container">
        <h1>{{CoffeeName}}</h1>
    <div class="row">
      <div class="col-md-4">
        {{#if AverageRating}}
        <div class="circle">
          <div class="overall"> Overall </div>
          <div class="rating-value">{{AverageRating}}</div>
        </div>
        {{/if}}
        <h3>{{CoffeeRoast}}</h3>
        <p style="margin-bottom: 25px"> Added {{tm_now CreatedAt}} by <a href="/mebrew/{{Username}}" class="">{{Username}}</a></p>
        {{#if ImageUrl}}
        <img src="{{ImageUrl}}" class="img-responsive" style="margin-bottom: 10px; max-height: 300px; object-fit:cover; width:100%" alt="...">
        {{else}}
        <img src="/img/default-brew.jpg" class="img-responsive" style="margin-bottom: 10px" alt="...">
        {{/if}}
        <button type="button" class="addRebrew btn btn-info" data-toggle="modal" data-target="#reBrewingModal" data-keyboard="true">Add a reBrew</button>
        {{#if InFavorites}}
        <button type="button" class="addToFavorites btn btn-success">Add to Favorites</button>
        {{else}}
        <button type="button" class="removeFromFavorites btn btn-success">Not a Favorite</button>
        {{/if}}
        {{#if isOwner}}
          <!-- <button type="button" class="btn btn-info editModal" data-toggle="modal" data-target="#EditBrewModal" data-keyboard="true">Edit Brew</button>
          <button type="button" class="btn btn-warning delModal" data-toggle="modal" data-target="#DeleteBrewModal" data-keyboard="true">Delete Brew</button> -->
          <div class="dropdown" style="position: absolute;top: 0px; right: 15px;">
              <i class="fa fa-pencil-square-o fa-2 dropdown-toggle" aria-hidden="true" data-toggle="dropdown" aria-expanded="false"></i>
              <ul class="dropdown-menu" style="position:relative">
                  <li><a class="editModal" data-toggle="modal" data-target="#EditBrewModal" data-keyboard="true">Edit</a></li>
                  <li><a class="delModal" data-toggle="modal" data-target="#DeleteBrewModal" data-keyboard="true">Delete</a></li>
              </ul>
          </div>
        {{/if}}
      </div>
      <div class="col-md-4" style="max-height: 500px; overflow: auto;">
        <h3>Brew Summary</h3>
        <p class="newlines">{{CoffeeDescription}}</p>


      </div>
      <div class="col-md-4">
        {{> canvas}}
      </div>
    </div>

    <div class="row">
      <div class="col-xs-12">
        <h3>Reviews <span class="badge">{{reBrewCount}}</span></h3>
      </div>
    </div>

    <div class="row v-align">
      {{#each reBrew}}
      {{> rebrew title=Title rebrew=Rebrew user=Username createdAt=ReviewDate ratingNum=Rating owner=Owner id=_id}}
      {{/each}}
    </div>
  </div>

  <!--Rebrewing Modal-->
  <div class="modal fade" id="reBrewingModal" role="dialog">
    <div class="modal-dialog modal-sm">
      <div class="modal-content">
        <div class="modal-header">
          <div class="row">
            <div class="col-md-2">

              {{#if isAdvanced}}
              <div style="position: absolute; font-size: 8px; cursor: pointer; margin: 0 auto; pointer-events: none; left: 25px; top: 35px;">
                Simple
              </div>
              <img class="toggleAdvanced btn btn-default" src="https://cdn4.iconfinder.com/data/icons/dot/256/cafe_coffee.png" style="height: 45px; width: 45px"/>
              {{else}}
              <div style="position: absolute; font-size: 8px; cursor: pointer; margin: 0 auto; pointer-events: none; left: 19px; top: 35px;">
                Advanced
              </div>

              <img class="toggleAdvanced btn btn-default" src="/img/advanced.jpg" style="height: 45px; width: 45px"/>
              {{/if}}
            </div>
            <div class="col-md-8">
              <h4 class="modal-title" style="position: relative; top: 7px;">
                How was the brew?
              </h4>
            </div>
            <div class="col-md-2">
              <button type="button" class="close" data-dismiss="modal">&times;</button>
            </div>
          </div>
        </div>
        <div class="modal-body">
          <form class="submitRebrew thumbnail">
            <div class="form-group">
              <label>Rebrew title</label>
              <input required type="text" name="title" class="form-control" placeholder="Add a title">
            </div>
            <div class="form-group">
              <label>Rebrew details</label>
              <textarea required type="text" name="rebrew" class="form-control"></textarea>
            </div>

            <div class="form-group" style="text-align:right">
              {{#if isAdvanced}}

              <label class="advlabel">Aroma</label>
              <div>
                <input id="adrating1" class="form-group slider" style="display:inline; width:66%;" type="range" min="0" max="10" value="5">
                <span class="badge" id="badrating1">5</span>
              </div>
              <label class="advlabel">Body</label>
              <div>
                <input id="adrating2" class="form-group slider" style="display:inline; width:66%;" type="range" min="0" max="10" value="5">
                <span class="badge" id="badrating2">5</span>
              </div>
              <label class="advlabel">Acidity</label>
              <div>
                <input id="adrating3" class="form-group slider" style="display:inline; width:66%;" type="range" min="0" max="10" value="5">
                <span class="badge" id="badrating3">5</span>
              </div>
              <label class="advlabel">Flavor</label>
              <div>
                <input id="adrating4" class="form-group slider" style="display:inline; width:66%;" type="range" min="0" max="10" value="5">
                <span class="badge" id="badrating4">5</span>
              </div>
              <label class="advlabel">Balance</label>
              <div>
                <input id="adrating5" class="form-group slider" style="display:inline; width:66%;" type="range" min="0" max="10" value="5">
                <span class="badge" id="badrating5">5</span>
              </div>
              {{else}}

              <label>Overall rating</label>
              <input id="irating" required class="form-group" type="hidden" name="rating" value="">
              <!-- https://atmospherejs.com/kosst/css-star-rating -->
              {{> rating value=0 }}

              {{/if}}
              <button class="btn btn-info" type="submit" style="float:right bottom; position: relative">
                <i class="fa fa-2x fa-coffee" aria-hidden="true"></i>
              </button>

            </div>
          </form>

        </div>
    </div>
  </div>
</div>

<!--DeleteBrew Modal-->
<div class="modal fade" id="DeleteBrewModal" role="dialog">
  <div class="modal-dialog modal-sm">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
        <h4 class="modal-title">Delete Brew</h4>
      </div>
      <div class="modal-body">
        <h6 class="modal-body">Are you sure you want to remove this brew?</h6>
        <input id="brewID" type="hidden" value="">
      </div>
      <div class="modal-footer">
        <button class="btn btn-warning delete" type="button">
          <i class="fa fa-check" aria-hidden="true"></i> OK
        </button>
        <button class="btn btn-danger" type="button" data-dismiss="modal">
          <i class="fa fa-times" aria-hidden="true"></i> Cancel
        </button>
      </div>
    </div>
  </div>
</div>

  <!--Edit brew Modal-->
<div class="modal fade" id="EditBrewModal" role="dialog">
  <div class="modal-dialog modal-sm">
    <div class="modal-content" style="padding-bottom:15px">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
        <h4 class="modal-title">Edit the Brew</h4>
      </div>
      <div class="modal-body">
          <form class="submitEditBrew thumbnail">
              <div class="form-group">
                  <label>Name</label>
                  <input required type="text" name="title" class="form-control" value="{{CoffeeName}}">
              </div>
              <div class="form-group">
                  <label>Roast</label>
                  <select required class="form-control" style="width:auto; height:auto; padding:10px; border-radius:10px;" id="roast" name="roast" value="{{CoffeeRoast}}">
                      <option style="color: #b69476" value="Light Roast">Light Roast</option>
                      <option style="color: #825d43" value="Medium Roast">Medium Roast</option>
                      <option style="color: #66290b" value="Medium-Dark Roast">Medium-Dark Roast</option>
                      <option style="color: #120907" value="Dark Roast">Dark Roast</option>
                  </select>
              </div>
              <div class="form-group">
                  <label>Image URL</label>
                  <input type="text" name="imageURL" class="form-control" value="{{ImageUrl}}" />
              </div>
              <div class="form-group">
                  <label>Description</label>
                  <textarea required class="form-control" value="{{CoffeeDescription}}" rows="3" name="description"></textarea>
              </div>
              <input id="editbrewID" type="hidden" value="">
              <button class="btn btn-info" type="submit" style="float:right">
                  <i class="fa fa-2x fa-coffee" aria-hidden="true"></i>
              </button>
          </form>
      </div>
    </div>
  </div>
</div>
{{/each}}
{{/if}}
{{/if}}
</template>

<template name ="canvas">
  <canvas id="myChart" width="200" height="200" ></canvas>
</template>
